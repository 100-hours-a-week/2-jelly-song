# 시간

- 13:00 ~ 17:00 : 싸피 특강
- 19:00 ~ 23:00 : 박재성 MSA 강의

# 간략 회고

### 박재성 MSA 강의

박재성 MSA 강의를 완강하였다.

유저 서비스, 게시글 서비스, 포인트 서비스로 이루어진 마이크로서비스 아키텍처를 구축해보았다.

구축하면서 신경써야 했던 부분은 트랜잭션이었는데 이부분을 saga 패턴을 적용해 해결하였다.

유저 서비스, 게시글 서비스, 포인트 서비스는 모두 데이터베이스가 분리되어 있기 떄문에 하나의 트랜잭션으로 묶을 수가 없다.

따라서 "수동"으로 트랜잭션을 보장해주어야하는데

만약 유저 서비스, 게시글 서비스, 포인트 서비스 순으로 요청이 처리된다고 하고 게시글 서비스에서 에러가 났다면 유저 서비스를 롤백 시켜주어야한다.

만약 유저 서비스에서 유저 포인트를 100포인트를 늘려주었다면 100포인트를 감소시켜주는 api를 호출시킴으로써 수동으로 롤백한다.

이것이 사가 패턴이다.

또한 동기로 msa를 구축하고 비동기 아키텍처를 이용해서 구축해 보았다.

게시글 서비스에서 포인트 서비스로의 요청은 "동기"로 구축하였다 그 이유는 게시글을 쓰려면 포인트가 필요한데 포인트가 있는지 동기로 받은다음

"응답 값"을 확인 후 다음 비즈니스 로직이 실행되어야 하기 때문이다. 그 뒤 유저 서비스는 kafka를 이용해 비동기로 처리하였다.

그 이유는 게시글을 작성했을 때 유저의 활동점수는 바로 올려줄 필요없이 언젠가 올려주기만 하면 되기 때문이다. 따라서 유저 서비스를 동기적으로 기다릴 필요없이

카프카에 메세징만 넣어두고 빠르게 api 요청을 처리할 수 있었다.