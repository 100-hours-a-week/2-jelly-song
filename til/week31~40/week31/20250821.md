# 시간

- 09:00 ~ 18:00 : 싸피
- 20:00 ~ 23:00 : 코딩 테스트 준비
- 23:00 ~ 24:00 : 우아한 테크, 레디스 컨퍼런스 수강 (1/2)

# 간략 회고

### 코딩 테스트 준비 (프로그래머스)

이번에 코딩 테스트를 풀면서 TreeSet의 유용성에 대해서 알게 되었다.

싸피에서 동료들과 알고리즘 관련하여 토론을 하는데 TreeSet 자료구조 관련해서 Heap 대신 사용해도 좋을 수 있다는 판단이 있었다.

이번 프로그래머스 고득점 키트 문제 https://school.programmers.co.kr/learn/courses/30/lessons/42628 에서 우선순위 큐를

최소힙, 최대힙을 둘다 수행하는 이중 우선순위 큐로 업그레이드 하라는 문제였다.

이를 본 순간 저번에 토론했던 TreeSet을 생각하게 되었고 TresSet으로 log(N)의 시간으로 업데이트 및 조회를 할 수 있는 알고리즘을

수행하였다. 대부분 우선순위 큐를 두개 선언하고 최대 힙에서 remove를 했을 경우 최소힙은 O(N)으로 순회한다음 remove하는 로직을

짜는 것이 솔루션이었던데, 동료들과 토론을 하지 않았다면 몰랐을 것이다. 토론의 중요성을 다시 한번 느끼게 해주었던 것 같다.

### 우아한 테크, 레디스 컨퍼런스 수강

레디스에 좀 더 공부하고 싶다고 생각하였고, 유튜브에 우아한 테크에서 레디스 관련 컨퍼런스가 있어서 수강하였다. 인상 깊었던 내용을 기록하면,

1. O(N) 명령을 조심하라.

예를 들어 Keys 같은 명령어를 사용하는 것을 조심해야 한다 레디스는 기본적으로 싱글 스레드 이므로 O(N) 명령어를 실행하면

그 명령어가 끝날 때 까지 기다려야 한다. Keys 명령어를 쓸일이 있을까? 싶지만 만약에 key들을 모니터링을 하기 위해 모든 Key를 가져오는 로직을 짤 수 있다.

이런 경우는 scan 명령으로 페이지네이션 처럼 하나씩 가져올 수 있는 방안이 있다. O(N) 명령대신 이렇게 대체할 수 있다면 대체제를 사용해야 한다.

2. Redis Replica 동작 과정

replica 레디스가 Primary 레디스에 replicaof 명령을 전달하면 Primary에 sync 명령이 전달된다.

그러면 Primary는 그 메모리 상태를 저장하기 위해서 Fork를 따는데 그 Fork 한 프로세서는 그 정보를 secondary에 전달한다.

그리고 그 이후의 데이터를 secondary에 계속 전달하면서 sync가 맞춰 지는 것이다.

3. redis.conf 권장 설정

우선 AOF의 설정은 off를 해놓는 것이 좋다! 그 이유는 AOF를 한다면 계속 보조기억장치에 접근하게 되는데 이 부분에 대해서 리소스가 너무 크다.

무조건 Primary Redis의 경우 off를 해두어야 하고, 만약 꼭 AOF를 해야한다면 secondary redis가 그 책임을 받아서 AOF를 수행한다고 말씀해주셨다.

또한 Maxclient 설정으로 들어올 수 있는 client 수를 조절할 수 있는데 기본값이 10000이기 때문에 사용자가 들어오지 못하는 일이 발생할 수 있다. 

따라서 50000으로 설정하는 등 늘리는 방향에 대해 생각을 해보아야 한다.